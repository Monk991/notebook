## 父子通信

- /src/views/demo/ParentItem.vue

```vue
<template>
  <div class="parent-box">
    父组件
    <div>名称:{{ name }}</div>
    <div>信息:{{ info }}</div>
    <div>爱好:{{ hobbies }}</div>
    <div>标签:{{ tag }}</div>
    <el-button @click="callChild">父调用子</el-button>
    <div>数据:{{ data }}</div>
    <el-button @click="loadData">加载数据</el-button>

    <child-item
      ref="childRef"
      :name="name"
      v-model:hobbies="hobbies"
      v-model:info="info"
      v-model:tag="tag"
      v-model:data="data"
      @on-click="changeName"
      class="child-box"
    />
  </div>
</template>
<script lang="ts" setup>
import ChildItem from './ChildItem.vue'

let name = ref('父')

const changeName = (_name: string) => {
  name.value = _name
}

const childRef = ref()

const callChild = () => {
  let exposeName: string = childRef.value?.exposeName
  name.value = exposeName
}

let info: object = reactive({
  remark: '父信息'
})

let hobbies: string[] = reactive(['足球'])

let tag = ref('父标签')

let data = ref()

const loadData = () => {
  data.value = {
    name: '父数据'
  }
}
</script>

<style>
.parent-box {
  border: 1px solid #f8f6c9;
  padding: 12px;
}

.child-box {
  border: 1px solid #f8f6c9;
  padding: 12px;
  margin-top: 12px;
}
</style>

</style>
```

- /src/views/demo/ChildItem.vue

```vue
<template>
  <div>
    <div>子组件</div>
    <div>名称:{{ name }}</div>
    <div>默认值:{{ sex }}</div>
    <el-button @click="callParent">子调用父</el-button>

    <div>对象:{{ info }}</div>
    <el-button @click="changeInfo">修改对象</el-button>

    <div>爱好:{{ hobbies }}</div>
    <el-button @click="addHobbies">增加列表</el-button>

    <div>父标签:{{ tag }}</div>
    <div>子标签:{{ childTag }}</div>
    <el-button @click="changeTag">修改只读</el-button>

    <div>数据: {{ data }}</div>
    <el-button @click="changeData">修改数据</el-button>
  </div>
</template>
<script lang="ts" setup>
type Props = {
  name: string
  hobbies: string[]
  sex?: string
  info: {
    remark?: string
  }
  tag: string
  data: any
}

const props = withDefaults(defineProps<Props>(), {
  sex: '男'
})

const emit = defineEmits(['on-click', 'update:tag'])

// ts写法
// const emit = defineEmits<{
//   (e: 'on-click', name: string): void
//   (e: 'update:hobbies', hobbies: string[]): void
// }>()

const callParent = () => {
  emit('on-click', '子 > 父')
}

// 对象
const changeInfo = () => {
  props.info.remark = '' + new Date().valueOf()
}

// 列表
const addHobbies = () => {
  props.hobbies.push('B')
}

// 解决: [Vue warn] target is readonly.
const childTag = ref()
watch(
  () => props.tag,
  (newValue) => {
    console.info('childTag')
    childTag.value = newValue
  },
  {
    immediate: true
  }
)

const changeTag = () => {
  childTag.value = '' + new Date().valueOf()
  emit('update:tag', childTag.value)
}

const changeData = () => {
  props.data.name = '' + new Date().valueOf()
}

defineExpose({
  exposeName: '子-Expose'
})
</script>
```

- /src/App.vue

```vue
<template>
  <parent-item />
</template>

<script setup lang="ts">
import ParentItem from '@/views/demo/ParentItem.vue'
</script>
```
